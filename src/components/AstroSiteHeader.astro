---
import AstroDropdown from "./AstroDropdown.astro";
---

<header
  id="site-header"
  class="fixed z-40 w-full bg-opacity-30 shadow backdrop-blur transition-transform duration-300"
>
  <div
    class="flex items-center md:items-baseline justify-between gap-12 px-8 max-w-screen-xl mx-auto my-4"
  >
    <a
      class="text-3xl md:text-4xl font-bold pb-2 md:pb-0"
      href="/"
      data-astro-reload
    >
      groundwaves
    </a>
    <div id="desktop" class="hidden md:flex items-center gap-6 w-full">
      <nav class="flex-initial md:flex-1 flex gap-6">
        <a class="afw-link font-semibold" href="/afw"> a friendly wave</a>
        <a href="/events">events</a>
        <a href="/about">about</a>
      </nav>
      <a href="https://rkbce3s6n3o.typeform.com/to/FMhtniXO">
        <button
          type="button"
          class="cta-button font-bold ml-auto"
          onclick="location.href='https://rkbce3s6n3o.typeform.com/to/FMhtniXO';"
          value="Join Mailing List"
        >
          Join
        </button>
      </a>
    </div>
    <AstroDropdown />
  </div>
</header>

<style>
  .hide-on-scroll {
    transform: translateY(-100%);
  }
</style>

<script is:inline>
  let lastScrollY = window.scrollY;
  let ticking = false;
  const header = document.getElementById("site-header");

  function onScroll() {
    if (!header) return;
    const currentScrollY = window.scrollY;
    if (currentScrollY > lastScrollY && currentScrollY > 10) {
      // Scrolling down
      header.classList.add("hide-on-scroll");
    } else {
      // Scrolling up
      header.classList.remove("hide-on-scroll");
    }
    lastScrollY = currentScrollY;
    ticking = false;
  }

  function requestTick() {
    if (!ticking) {
      requestAnimationFrame(onScroll);
      ticking = true;
    }
  }

  window.addEventListener("scroll", requestTick);
</script>
